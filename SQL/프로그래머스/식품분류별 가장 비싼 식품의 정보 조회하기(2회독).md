```sql
SELECT CATEGORY, MAX(PRICE) AS MAX_PRICE, PRODUCT_NAME
FROM FOOD_PRODUCT 
WHERE PRICE IN (SELECT MAX(PRICE) FROM FOOD_PRODUCT GROUP BY CATEGORY)
AND CATEGORY IN ('과자', '국', '김치', '식용유') 
GROUP BY CATEGORY
ORDER BY MAX_PRICE DESC
```

- 서브쿼리에서 이미 "카테고리별 최대 가격"으로 필터링 → `PRODUCT_NAME`이 그 최대값과 정확히 일치.

```sql
SELECT CATEGORY, MAX(PRICE) AS MAX_PRICE, PRODUCT_NAME
FROM FOOD_PRODUCT 
WHERE CATEGORY IN ('과자', '국', '김치', '식용유')
GROUP BY CATEGORY
ORDER BY MAX_PRICE DESC
```

- `GROUP BY CATEGORY` 를 쓰면, `CATEGORY`별로 **하나의 행**만 남겨야 해요.
- 그런데 `PRODUCT_NAME` 은 `GROUP BY`에도 없고, `집계 함수`(MAX, MIN 등)도 아니죠.
    
    → SQL 규칙상 애매한 값이 되어서, DBMS에 따라 에러가 나거나 임의의 값이 출력될 수 있어요.
    
- 그래서 "카테고리별 최고 가격 상품 이름"을 보장하지 못해요.
    
    즉, `MAX(PRICE)`는 제대로 구하지만 그에 대응하는 `PRODUCT_NAME`이 틀릴 수 있습니다.
    

👉 보통 이런 문제에서는 `JOIN` 방식으로 더 직관적으로도 많이 사:

```sql
SELECT F.CATEGORY, F.PRICE AS MAX_PRICE, F.PRODUCT_NAME
FROM FOOD_PRODUCT F
JOIN (
    SELECT CATEGORY, MAX(PRICE) AS MAX_PRICE
    FROM FOOD_PRODUCT
    GROUP BY CATEGORY
) M
ON F.CATEGORY = M.CATEGORY AND F.PRICE = M.MAX_PRICE
WHERE F.CATEGORY IN ('과자', '국', '김치', '식용유')
ORDER BY MAX_PRICE DESC;

```
